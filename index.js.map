{"version":3,"file":"index.js","sources":["src/actions.js","src/selectors.js","src/reducer.js","src/index.js"],"sourcesContent":["export const SET = prefix => `SET_${prefix}`\nexport const set = prefix => payload => ({ type: SET(prefix), payload })\n\nexport const RESET = prefix => `RESET_${prefix}`\nexport const reset = prefix => () => ({ type: RESET(prefix) })\n\nexport const ADD = prefix => `ADD_${prefix}`\nexport const add = prefix => payload => ({ type: ADD(prefix), payload })\n\nexport const DEL = prefix => `DEL_${prefix}`\nexport const del = prefix => key => ({ type: DEL(prefix), payload: key })\n","import { at } from 'lodash'\n\nexport const getState = path => prefix => (state) => {\n  let subState = state\n  if (path !== undefined) subState = at(state, path)[0]\n\n  return subState[prefix]\n}\n\nconst getFactory = key => path => prefix => state => getState(path)(prefix)(state)[key]\nexport const getKeys = getFactory('keys')\nexport const getNb = getFactory('nb')\nexport const getDatas = getFactory('datas')\nexport const isInitialized = getFactory('initialized')\n\nexport const getByIds = path => prefix => state => (keys) => {\n  if (Array.isArray(keys)) return keys.map(k => getDatas(path)(prefix)(state)[k])\n  return getDatas(path)(prefix)(state)[keys]\n}\n","import { keyBy, without, uniq, omit } from 'lodash'\nimport { SET, ADD, DEL, RESET } from './actions'\n\nexport const initState = { datas: {}, keys: [], nb: 0, initialized: false }\n\nexport default key => prefix =>\n  (state = initState, { type = 'UNKONWN', payload } = {}) => {\n    switch (type) {\n      case SET(prefix):\n        return {\n          datas: keyBy(payload, key),\n          keys: payload.map(element => element[key]),\n          nb: payload.length,\n          initialized: true,\n        }\n      case ADD(prefix):\n        return {\n          ...state,\n          datas: { ...state.datas, [payload[key]]: payload },\n          keys: uniq([...state.keys, payload[key]]),\n          nb: state.keys.length + 1,\n          initialized: true,\n        }\n      case DEL(prefix):\n        return {\n          ...state,\n          datas: omit(state.datas, [payload]),\n          keys: without(state.keys, payload),\n          nb: state.keys.length - 1,\n        }\n      case RESET(prefix):\n        return initState\n      default:\n        return state\n    }\n  }\n","import * as actions from './actions'\nimport * as selectors from './selectors'\nimport reducer from './reducer'\n\nexport default key => path => prefix => Object.assign(\n  reducer(key)(prefix),\n  ...Object.keys(actions).map(k => ({ [k]: actions[k](prefix) })),\n  ...Object.keys(selectors).map(k => ({ [k]: selectors[k](path)(prefix) })),\n)\n"],"names":["SET","prefix","RESET","ADD","DEL","type","payload","key","getState","state","subState","undefined","path","_at","getFactory","getKeys","getNb","getDatas","isInitialized","keys","Array","isArray","map","k","initState","datas","nb","initialized","_keyBy","element","length","_uniq","_omit","_without","Object","assign","reducer","actions","selectors"],"mappings":"klBAAO,IAAMA,EAAM,yBAAiBC,GAGvBC,EAAQ,2BAAmBD,GAG3BE,EAAM,yBAAiBF,GAGvBG,EAAM,yBAAiBH,8BARjB,mBAAU,mBAAcI,KAAML,EAAIC,GAASK,2BAGzC,mBAAU,kBAASD,KAAMH,EAAMD,gBAGjC,mBAAU,mBAAcI,KAAMF,EAAIF,GAASK,uBAG3C,mBAAU,mBAAUD,KAAMD,EAAIH,GAASK,QAASC,OCRtDC,EAAW,mBAAQ,mBAAU,SAACC,OACrCC,EAAWD,cACFE,IAATC,IAAoBF,EAAWG,EAAGJ,EAAOG,GAAM,IAE5CF,EAAST,MAGZa,EAAa,mBAAO,mBAAQ,mBAAU,mBAASN,EAASI,GAAMX,GAAQQ,GAAOF,OACtEQ,EAAUD,EAAW,QACrBE,EAAQF,EAAW,MACnBG,EAAWH,EAAW,SACtBI,EAAgBJ,EAAW,iGAEhB,mBAAQ,mBAAU,mBAAS,SAACK,UAC9CC,MAAMC,QAAQF,GAAcA,EAAKG,IAAI,mBAAKL,EAASL,GAAMX,GAAQQ,GAAOc,KACrEN,EAASL,GAAMX,GAAQQ,GAAOU,+ZCd1BK,GAAcC,SAAWN,QAAUO,GAAI,EAAGC,aAAa,wBAE9C,mBACpB,eAAClB,yDAAQe,kEAAanB,KAAAA,aAAO,YAAWC,IAAAA,eAC9BD,QACDL,EAAIC,gBAEE2B,EAAMtB,EAASC,QAChBD,EAAQgB,IAAI,mBAAWO,EAAQtB,QACjCD,EAAQwB,oBACC,QAEZ3B,EAAIF,eAEFQ,cACSA,EAAMgB,WAAQnB,EAAQC,GAAOD,SACnCyB,cAAStB,EAAMU,OAAMb,EAAQC,SAC/BE,EAAMU,KAAKW,OAAS,eACX,SAEZ1B,EAAIH,eAEFQ,SACIuB,EAAKvB,EAAMgB,OAAQnB,SACpB2B,EAAQxB,EAAMU,KAAMb,MACtBG,EAAMU,KAAKW,OAAS,SAEvB5B,EAAMD,UACFuB,iBAEAf,gCC7BO,mBAAQ,mBAAUyB,OAAOC,qBAC7CC,EAAQ7B,GAAKN,aACViC,OAAOf,KAAKkB,GAASf,IAAI,wBAASC,EAAIc,EAAQd,GAAGtB,SACjDiC,OAAOf,KAAKmB,GAAWhB,IAAI,wBAASC,EAAIe,EAAUf,GAAGX,GAAMX"}