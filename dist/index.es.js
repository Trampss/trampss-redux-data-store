import{omit as n,orderBy as t,get as r,at as e}from"lodash";var u,i,o=function(n){return"@@krf/"+n.toUpperCase()},c=function(n){return function(t){return(n?">":"")+n+">"+t}},a=function(n){return function(t){return o("SET"+c(n)(t))}},f=function(n){return function(t){return function(r){return{type:a(n)(t),payload:r}}}},s=function(n){return function(t){return o("RESET"+c(n)(t))}},d=function(n){return function(t){return function(){return{type:s(n)(t)}}}},y=function(n){return function(t){return o("ADD"+c(n)(t))}},p=function(n){return function(t){return o("UPDATE"+c(n)(t))}},l=function(n){return function(t){return function(r){return{type:p(n)(t),payload:r}}}},v=function(n){return function(t){return o("REMOVE"+c(n)(t))}},g=function(n){return function(t){return o("ADD_OR_UPDATE"+c(n)(t))}},O=function(n){return function(t){return o("REPLACE"+c(n)(t))}},E=function(n){return function(t){return o("ORDER_BY"+c(n)(t))}},b={set:f,SET:a,add:function(n){return function(t){return function(r){return{type:y(n)(t),payload:r}}}},ADD:y,reset:d,RESET:s,remove:function(n){return function(t){return function(r){return{type:v(n)(t),payload:r}}}},REMOVE:v,update:l,UPDATE:p,addOrUpdate:function(n){return function(t){return function(r){return{type:g(n)(t),payload:r}}}},ADD_OR_UPDATE:g,replace:function(n){return function(t){return function(r){return{type:O(n)(t),payload:r}}}},REPLACE:O,orderBy:function(n){return function(t){return function(r){return{type:E(n)(t),payload:r}}}},ORDER_BY:E},j={data:{},keys:[],array:[],initialized:!1},m=function(n,t){var r={};return function(n){return Array.isArray(n)?n:[n]}(t).forEach(function(t){r[t[n]]=t}),r},A=function(n){return function(t){return void 0!==n.data[t]}},D=function(n){return function(t){return Object.assign({},n,{data:t,keys:Object.keys(t),array:Object.values(t),initialized:!0})}},k=function(n,t,r){return D(t)(m(n,r))},R=function(n,t,r){var e=r[n];return D(t)(Object.assign({},t.data,((u={})[e]=r,u)))},T=function(n,t,r){var e=r[n];return D(t)(Object.assign({},t.data,((i={})[e]=Object.assign({},t.data[e],r),i)))},h=function(n,t){return void 0!==t?k(n,{},t):j},U=function(e){return function(u){return function(i){return function(o){return function(c,f){void 0===c&&(c=h(e,o)),void 0===f&&(f={});var d=f.payload;switch(f.type){case a(u)(i):return k(e,c,d);case y(u)(i):return R(e,c,d);case g(u)(i):return T(e,c,d);case v(u)(i):return function(t,r,e){return D(r)(n(r.data,[].concat(e)))}(0,c,d);case s(u)(i):return h(e,o);case p(u)(i):return A(c)(d[e])?T(e,c,d):c;case O(u)(i):return A(c)(d[e])?R(e,c,d):c;case E(u)(i):var l=d,b="asc";"object"==typeof d&&d.by&&(l=d.by,b=d.desc?"desc":"asc");var j=t(c.array,"string"==typeof l?function(n){return r(n,l)}:l,b);return Object.assign({},c,{array:j,keys:j.map(function(n){return n[e]})});default:return c}}}}}};var w=function(n){return function(t){var r=t,u=n.name,i=n.path;void 0!==i&&i.length>0&&(r=e(t,i)[0]);return r[u]}},P=function(n){return function(t){return function(r){return w(t)(r)[n]}}},S=P("keys"),_=P("array"),z=P("initialized"),V={},B=function(n){return void 0!==n?n:V},x=function(){return function(n){return function(t){return function(r){return function(e,u){void 0===e&&(e=B(r)),void 0===u&&(u={});var i=u.payload;switch(u.type){case a(n)(t):return i;case p(n)(t):return Object.assign({},e,i);case s(n)(t):return B(r);default:return e}}}}}};var C,K,L=function(n){return function(){return function(t){return w(n)(t)}}},N={keyValue:{middlewares:[function(n){return function(t){return function(r){return function(e){return function(u){return void 0===u&&(u={}),Object.assign({},u,{state:U(n)(t)(r)(e)(u.state,u.action)})}}}}}],actions:b,selectors:{getState:w,getKeys:S,getAsArray:_,getLength:function(n){return function(t){return S(n)(t).length}},isInitialized:z,get:function(n){return function(t){return function(r){var e=function(n){return P("data")(n)}(n)(r);return null==t?e:Array.isArray(t)?t.map(function(n){return e[n]}):e[t]}}},getBy:function(n){return function(t,r){return function(u){var i=_(n)(u);return Array.isArray(r)?i.filter(function(n){return r.includes(e(n,t)[0])}):i.filter(function(n){return r===e(n,t)[0]})}}},hasKey:function(n){return function(t){return function(r){return S(n)(r).includes(t)}}}}},simpleObject:{middlewares:[function(n){return function(t){return function(r){return function(e){return function(u){return void 0===u&&(u={}),Object.assign({},u,{state:x(n)(t)(r)(e)(u.state,u.action)})}}}}}],actions:{set:f,SET:a,reset:d,RESET:s,update:l,UPDATE:p},selectors:{get:L,isInitialized:function(n){return function(t){return void 0!==n.defaultData?w(n)(t)!==n.defaultData:L(n)()(t)!==V}}}}};var I=function(n){return void 0===n&&(n={}),function(t){var r=t.key,e=t.type;void 0===e&&(e="keyValue");var u=t.prefix;void 0===u&&(u="");var i=t.name,o=t.defaultData,c=N[e];return Object.assign.apply(Object,[function(n){return function(t){return function(r){return function(e){return function(u){return function(i,o){void 0===o&&(o={});var c=o.type;void 0===c&&(c="UNKNOWN");var a={state:i,action:{type:c,payload:o.payload}};return(n.pre||[].concat(n.engine||[],n.post||[])).map(function(n){return n(t)(r)(e)(u)}).forEach(function(n){a=n(a)}),a.state}}}}}}(Object.assign({},n,{engine:c.middlewares}))(r)(u)(i)(o),{krfType:e}].concat(Object.keys(c.actions).map(function(n){return(C={})[n]=c.actions[n](u)(i),C}),Object.keys(c.selectors).map(function(n){return(K={})[n]=c.selectors[n](t),K})))}},M=function(){throw Error("parameter is not a middleware configuration, nor a factory option object.")},Y=function(n){return void 0===n&&(n={}),function(t){return null==t&&M(),function(n){return n.engine||n.pre||n.post}(t)?function(r){return I(t)(Object.assign({},r,n))}:function(n){return!!n.name||"string"==typeof n}(t)?"string"==typeof t?I()(Object.assign({},{name:t},n)):I()(Object.assign({},t,n)):void M()}},W=Y({type:"simpleObject"}),q=Y({type:"keyValue"});export default Y();export{W as simpleObject,q as keyValue};
