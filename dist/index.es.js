function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function t(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function r(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),r.push.apply(r,e)}return r}function e(n){for(var e=1;e<arguments.length;e++){var u=null!=arguments[e]?arguments[e]:{};e%2?r(u,!0).forEach(function(r){t(n,r,u[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(u)):r(u).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(u,t))})}return n}function u(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var r=[],e=!0,u=!1,o=void 0;try{for(var i,c=n[Symbol.iterator]();!(e=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);e=!0);}catch(n){u=!0,o=n}finally{try{e||null==c.return||c.return()}finally{if(u)throw o}}return r}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(n){return function(n){if(Array.isArray(n)){for(var t=0,r=new Array(n.length);t<n.length;t++)r[t]=n[t];return r}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=function(n){return"@@krf/".concat(n.toUpperCase())},c=function(n){return function(t){return"".concat(n?">":"").concat(n,">").concat(t)}},a=function(n){return function(t){return i("SET".concat(c(n)(t)))}},f=function(n){return function(t){return function(r){return{type:a(n)(t),payload:r}}}},l=function(n){return function(t){return i("RESET".concat(c(n)(t)))}},s=function(n){return function(t){return function(){return{type:l(n)(t)}}}},p=function(n){return function(t){return i("ADD".concat(c(n)(t)))}},y=function(n){return function(t){return i("UPDATE".concat(c(n)(t)))}},d=function(n){return function(t){return function(r){return{type:y(n)(t),payload:r}}}},m=function(n){return function(t){return i("REMOVE".concat(c(n)(t)))}},v=function(n){return function(t){return i("ADD_OR_UPDATE".concat(c(n)(t)))}},b={data:[],initialized:!1},g=function(n){return Array.isArray(n)?n:[n]},h=function(n,t){return t.map(function(t){return[t[n],t]})},O=function(n){return function(t){return e({},n,{data:t,initialized:!0})}},A=function(n,t,r){return O(t)(h(n,g(r)))},E=function(n){return function(t,r,u){var o=new Map(r.data);return g(u).forEach(function(r){var u=o.get(r[t]);(n||r)&&o.set(r[t],e({},u,{},r))}),0===o.size?r:O(r)(Array.from(o.entries()))}},j=function(n,t){return void 0!==t?A(n,b,t):b},w=function(t){return function(r){return function(e){return function(u){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j(t,u),c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=c.payload;switch(c.type){case a(r)(e):return A(t,i,f);case p(r)(e):return function(n,t,r){return O(t)(Array.from(new Map(o(t.data).concat(o(h(n,g(r)))))))}(t,i,f);case v(r)(e):return E(!0)(t,i,f);case m(r)(e):return function(t,r,e){var u=new Map(r.data);return g(e).forEach(function(r){u.delete("object"===n(r)?r[t]:r)}),O(r)(Array.from(u.entries()))}(t,i,f);case l(r)(e):return j(t,u);case y(r)(e):return E(!1)(t,i,f);default:return i}}}}}},D=function(n,t){return t.split(".").reduce(function(n,t){return n&&n[t]},n)},S=function(n){var t={data:void 0,result:void 0};return function(r){return t.data!==r&&(t.data=r,t.result=n(r)),t.result}},P=function(n){return function(t){var r=n.path,e=n.name,u=t;return void 0!==r&&r.length>0&&(u=D(t,r)),u[e]}},T={},k=function(n){return void 0!==n?n:T},U={middlewares:[function(n){return function(n){return function(t){return function(r){return function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e({},u,{state:function(n){return function(t){return function(r){return function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k(r),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.payload;switch(o.type){case a(n)(t):return i;case y(n)(t):return e({},u,{},i);case l(n)(t):return k(r);default:return u}}}}}(n)(t)(r)(u.state,u.action)})}}}}}],actions:{set:f,SET:a,reset:s,RESET:l,update:d,UPDATE:y},selectors:function(n){var t=P(n),r=function(){return function(n){return t(n)}};return{get:r,isInitialized:function(t){return void 0!==n.defaultData?r()(t)!==n.defaultData:r()(t)!==T}}}},R={keyValue:{middlewares:[function(n){return function(t){return function(r){return function(u){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e({},o,{state:w(n)(t)(r)(u)(o.state,o.action)})}}}}}],actions:{set:f,SET:a,add:function(n){return function(t){return function(r){return{type:p(n)(t),payload:r}}}},ADD:p,reset:s,RESET:l,remove:function(n){return function(t){return function(r){return{type:m(n)(t),payload:r}}}},REMOVE:m,update:d,UPDATE:y,addOrUpdate:function(n){return function(t){return function(r){return{type:v(n)(t),payload:r}}}},ADD_OR_UPDATE:v},selectors:function(n){var t=P(n),r=function(n){return t(n).data},e=S(function(n){return new Map(n)}),o=S(function(n){return Array.from(e(n).keys())}),i=S(function(n){return Array.from(e(n).values())}),c=S(function(n){var t={};return n.forEach(function(n){var r=u(n,2);t[r[0]]=r[1]}),t});return{get:function(n){return function(t){var u=r(t);if(null==n)return c(u);var o=e(u);return Array.isArray(n)?n.map(function(n){return o.get(n)}):o.get(n)}},getKeys:function(n){return o(r(n))},getBy:function(n,t){return function(u){var o=i(e(r(u)));return Array.isArray(t)?o.filter(function(r){return t.includes(D(r,n))}):o.filter(function(r){return t===D(r,n)})}},getState:t,getAsArray:function(n){return i(r(n))},getLength:function(n){return r(n).length},hasKey:function(n){return function(t){return e(r(t)).has(n)}},isInitialized:function(n){return t(n).initialized}}}},simple:U,simpleObject:U},z=function(n){return function(t){return function(r){return function(e){return function(u){return function(i){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=c.type,f={state:i,action:{type:void 0===a?"UNKNOWN":a,payload:c.payload}};return o(n.pre||[]).concat(o(n.engine||[]),o(n.post||[])).map(function(n){return n(t)(r)(e)(u)}).forEach(function(n){f=n(f)}),f.state}}}}}},M={key:"id",type:"keyValue",prefix:""},x={bool:!1,string:"",array:[],object:{},number:0},V=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var r=e({},M,{},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),i=r.key,c=r.type,a=r.prefix,f=r.name,l=r.defaultData;"simpleObject"===c&&console.warn('/k-redux-factory/ You are using a deprecated "simpleObject" type. We recommend using one of these types: simple.object, simple.array, simple.bool or simple.string.');var s=u(c.split("."),2),p=s[1],y=R[s[0]];return void 0===l&&p&&(r.defaultData=x[p]),Object.assign.apply(Object,[z(e({},n,{engine:y.middlewares}))(i)(a)(f)(r.defaultData),{krfType:c}].concat(o(Object.keys(y.actions).map(function(n){return t({},n,y.actions[n](a)(f))})),[y.selectors(r)]))}},I=function(){throw Error("parameter is not a middleware configuration, nor a factory option object.")},_=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return null==t?I():function(n){return n.engine||n.pre||n.post}(t)?function(r){return V(t)(e({},r,{},n))}:function(n){return!!n.name||"string"==typeof n}(t)?"string"==typeof t?V()(e({name:t},n)):V()(e({},t,{},n)):I()}},K=_({type:"keyValue"}),N=_({type:"simple"});Object.assign(N,{object:_({type:"simple.object"}),bool:_({type:"simple.bool"}),string:_({type:"simple.string"}),array:_({type:"simple.array"}),number:_({type:"simple.number"})});var W=N,B=_();export{B as factory,N as simple,K as keyValue,W as simpleObject};
