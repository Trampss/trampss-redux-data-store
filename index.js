!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash")):"function"==typeof define&&define.amd?define(["exports","lodash"],t):t(n["k-redux-factory"]={},n._)}(this,function(n,t){"use strict";var r=function(n){return"@@krf/"+n.toUpperCase()},e=function(n){return function(t){return(n?">":"")+n+">"+t}},u=function(n){return function(t){return r("SET"+e(n)(t))}},i=function(n){return function(t){return function(r){return{type:u(n)(t),payload:r}}}},o=function(n){return function(t){return r("RESET"+e(n)(t))}},a=function(n){return function(t){return function(){return{type:o(n)(t)}}}},c=function(n){return function(t){return r("ADD"+e(n)(t))}},f=function(n){return function(t){return r("UPDATE"+e(n)(t))}},d=function(n){return function(t){return function(r){return{type:f(n)(t),payload:r}}}},s=function(n){return function(t){return r("REMOVE"+e(n)(t))}},y=function(n){return function(t){return r("ADD_OR_UPDATE"+e(n)(t))}},l=function(n){return function(t){return r("REPLACE"+e(n)(t))}},p=function(n){return function(t){return r("ORDER_BY"+e(n)(t))}},v=Object.freeze({set:i,SET:u,add:function(n){return function(t){return function(r){return{type:c(n)(t),payload:r}}}},ADD:c,reset:a,RESET:o,remove:function(n){return function(t){return function(r){return{type:s(n)(t),payload:r}}}},REMOVE:s,update:d,UPDATE:f,addOrUpdate:function(n){return function(t){return function(r){return{type:y(n)(t),payload:r}}}},ADD_OR_UPDATE:y,replace:function(n){return function(t){return function(r){return{type:l(n)(t),payload:r}}}},REPLACE:l,orderBy:function(n){return function(t){return function(r){return{type:p(n)(t),payload:r}}}},ORDER_BY:p}),g=function(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n},m=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},h=function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)},E={data:{},keys:[],array:[],initialized:!1},O=function(n){return function(t,r){return n.array.find(function(n){return n[t]===r})}},b=function(n,r){return{data:t.keyBy(r,n),keys:t.uniq(r.map(function(t){return t[n]})),array:r,initialized:!0}},A=function(n,r,e){var u=void 0,i=e[n];return u=O(r)(n,i)?r.array.map(function(t){return t[n]===i?e:t}):[].concat(h(r.array),[e]),m({},r,{data:m({},r.data,g({},i,e)),keys:t.uniq([].concat(h(r.keys),[i])),array:u,initialized:!0})},k=function(n,t,r){var e=r[n];return m({},t,{data:m({},t.data,g({},e,m({},t.data[e],r))),array:t.array.map(function(t){return t[n]===e?m({},t,r):t})})},j=function(n,t,r){var e=r[n];return m({},t,{data:m({},t.data,g({},e,r)),array:t.array.map(function(t){return t[n]===e?r:t})})},D=function(n,t){return void 0!==t?b(n,t):E},R=function(n){return function(r){return function(e){return function(i){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D(n,i),d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=d.type,g=d.payload;switch(v){case u(r)(e):return b(n,g);case c(r)(e):return A(n,a,g);case y(r)(e):return O(a)(n,g[n])?k(n,a,g):A(n,a,g);case f(r)(e):return O(a)(n,g[n])?k(n,a,g):a;case l(r)(e):return O(a)(n,g[n])?j(n,a,g):a;case p(r)(e):var E=g,R="asc";t.isObjectLike(g)&&(E=g.by,R=g.desc?"desc":"asc");var T=t.orderBy(a.array,t.isString(E)?function(n){return t.get(n,E)}:E,R);return m({},a,{array:T,keys:t.uniq(T.map(function(t){return t[n]}))});case s(r)(e):var z=t.flatten([g]);return m({},a,{data:t.omit(a.data,z),keys:t.without.apply(void 0,[a.keys].concat(h(z))),array:a.array?a.array.filter(function(t){return!z.includes(t[n])}):[]});case o(r)(e):return D(n,i);default:return a}}}}}},T=function(n){return function(r){var e=r,u=n.name,i=n.path;return void 0!==i&&i.length>0&&(e=t.at(r,i)[0]),e[u]}},z=function(n){return function(t){return function(r){return T(t)(r)[n]}}},w=z("keys"),P=z("array"),_=z("initialized"),S=function(n){return z("data")(n)},U={middlewares:[function(n){return function(t){return function(r){return function(e){return function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m({},u,{state:R(n)(t)(r)(e)(u.state,u.action)})}}}}}],actions:v,selectors:Object.freeze({getState:T,getKeys:w,getAsArray:P,getLength:function(n){return function(t){return w(n)(t).length}},isInitialized:_,get:function(n){return function(t){return function(r){var e=S(n)(r);return t?Array.isArray(t)?t.map(function(n){return e[n]}):e[t]:e}}},getBy:function(n){return function(r,e){return function(u){var i=P(n)(u);return Array.isArray(e)?i.filter(function(n){return e.includes(t.at(n,r)[0])}):i.filter(function(n){return e===t.at(n,r)[0]})}}},hasKey:function(n){return function(t){return function(r){return w(n)(r).includes(t)}}}})},B={},V=function(n){return void 0!==n?n:B},x=function(){return function(n){return function(t){return function(r){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V(r),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.type,c=i.payload;switch(a){case u(n)(t):return c;case f(n)(t):return m({},e,c);case o(n)(t):return V(r);default:return e}}}}}},q=function(n){return function(){return function(t){return T(n)(t)}}},L={middlewares:[function(n){return function(n){return function(t){return function(r){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m({},e,{state:x()(n)(t)(r)(e.state,e.action)})}}}}}],actions:Object.freeze({set:i,SET:u,reset:a,RESET:o,update:d,UPDATE:f}),selectors:Object.freeze({get:q,isInitialized:function(n){return function(t){return void 0!==n.defaultData?T(n)(t)!==n.defaultData:q(n)()(t)!==B}}})},C=Object.freeze({keyValue:U,simpleObject:L}),K=function(n){return function(t){return function(r){return function(e){return function(u){return function(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.type,c={state:i,action:{type:void 0===a?"UNKNOWN":a,payload:o.payload}};return[].concat(h(n.pre||[]),h(n.engine||[]),h(n.post||[])).map(function(n){return n(t)(r)(e)(u)}).forEach(function(n){c=n(c)}),c.state}}}}}},M=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var r=t.key,e=t.type,u=void 0===e?"keyValue":e,i=t.prefix,o=void 0===i?"":i,a=t.name,c=t.defaultData,f=C[u];return Object.assign.apply(Object,[K(m({},n,{engine:f.middlewares}))(r)(o)(a)(c),{krfType:u}].concat(h(Object.keys(f.actions).map(function(n){return g({},n,f.actions[n](o)(a))})),h(Object.keys(f.selectors).map(function(n){return g({},n,f.selectors[n](t))}))))}},N=function(){throw Error("parameter is not a middleware configuration, nor a factory option object.")},I=function(n){return n.engine||n.pre||n.post},Y=function(n){return!!n.name||"string"==typeof n},W=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return null!==t&&void 0!==t||N(),I(t)?function(r){return M(t)(m({},r,n))}:Y(t)?"string"==typeof t?M()(m({name:t},n)):M()(m({},t,n)):void N()}},F=W({type:"simpleObject"}),G=W({type:"keyValue"}),H=W();n.simpleObject=F,n.keyValue=G,n.default=H,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
